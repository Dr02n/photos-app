mixin photo-details(photo)
  .mdc-card.photo-card.photo-card--with-avatar(style='height: 100%; justify-content: flex-start;')
    .mdc-card__primary
      a.photo-card__avatar-link(href=`/users/${photo.author.id}`)
        img.photo-card__avatar(src=photo.author.avatar alt=photo.author.displayName)
      h1.mdc-card__title
        a.mdc-theme--primary(href=`/users/${photo.author.id}`)= photo.author.displayName
      h2.mdc-card__subtitle
        a.mdc-theme--primary(href=`/albums/${photo.album.id}`)= photo.album.name
    div

    .mdc-card__supporting-text
      .mdc-typography--title.mdc-typography--adjust-margin= photo.name
      if !photo.description
        if photo.author.id === user.id
          form(action=`/photos/${photo.id}` method='POST' style='margin: -0.25rem 0 0.75rem 0;')
            +method('PATCH')
            +csrf(csrf)
            label.mdc-textfield(data-mdc-auto-init='MDCTextfield' style='width: 100%; margin-top: 0;')
              input.mdc-textfield__input(type='text' name='description' required)
              span.mdc-textfield__label Add photo description
              .mdc-textfield__bottom-line
        else
          .mdc-typography--body1.mdc-typography--adjust-margin No description...
      else
        .mdc-typography--body1.mdc-typography--adjust-margin= photo.description
      .mdc-typography--caption.mdc-typography--adjust-margin.mdc-theme--primary-light= 'added ' + moment(photo.createdAt).fromNow()

      a.mdc-button.mdc-button--compact.mdc-card__action(href=`/photos/${photo.id}/like` data-mdc-auto-init='MDCRipple')
        i.material-icons.mdc-button__icon= photo.isLiked ? 'favorite' : 'favorite_bordered'
        | #{photo.likesCount}
      button.mdc-button.mdc-button--compact.mdc-card__action(data-mdc-auto-init='MDCRipple')
        i.material-icons.mdc-button__icon mode_edit
        | Edit

      br
      br

      .mdc-typography--subheading.mdc-typography--adjust-margin= `${photo.comments.length} Comments`
      div(style='display: flex; align-items: center;')
        img(src=user.avatar alt=user.name width=40 height=40 style='margin: 0 16px; border-radius: 50%;')
        form(action=`/photos/${photo.id}/comments` method='POST')
          +method('PUT')
          +csrf(csrf)
          label.mdc-textfield(data-mdc-auto-init='MDCTextfield' style='width: 100%; margin-top: 0;')
            input.mdc-textfield__input(type='text' name='text' required)
            span.mdc-textfield__label Add a comment...
            .mdc-textfield__bottom-line

      ul.mdc-list.mdc-list--two-line.mdc-list--dense.mdc-list--avatar-list
        for comment in photo.comments
          li.mdc-list-item
            img.mdc-list-item__start-detail.grey-bg(src=comment.author.avatar)
            span.mdc-list-item__text
              | #{comment.author.displayName}
              span.mdc-list-item__text__secondary= comment.text
          li.mdc-list-divider.mdc-list-divider--inset
